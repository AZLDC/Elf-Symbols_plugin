# 新注音繁簡快速切換

透過熱鍵與系統托盤圖示，在微軟「新注音」輸入法中切換「繁體／簡體輸出」模式。
程式會讀寫使用者登錄檔中的 `Enable Simplified Chinese Output`，並同步更新托盤圖示與提示文字。

---

## 快速開始（推薦）

### 方式 A：讓 `.pyw` 點兩下就能執行（最省事）
1. 在檔案總管找到任一個 `.pyw`（例如 `新注音繁簡快速切換.pyw`）

2. 右鍵該檔案 → 「開啟檔案」→「選擇其他應用程式」
   - 小提醒：選單上是「開啟檔案」，不是「開啟」
3. 選擇 `pythonw.exe`（GUI 執行檔）
   - 常見位置示例：`C:\Python312\pythonw.exe`
4. 勾選「一律使用此應用程式開啟 .pyw 檔案」→「確定」
5. 之後所有 `.pyw` 都可直接點兩下啟動

### 方式 B：用批次檔 `run.bat` 啟動
1. 將 `run.bat` 與 `新注音繁簡快速切換.pyw` 放在同一資料夾

2. 點兩下 `run.bat`
3. `run.bat` 會嘗試用 `py -3` 執行腳本
   - 若找不到 `py.exe` 會顯示提示並結束

---

## 使用中操作

### 啟動後會做的事
- 讀取登錄檔並顯示目前輸出模式
- 以 Win32 API 建立原生托盤視窗並載入 PNG 圖示
- 監聽熱鍵：Alt、Alt、W（需在 0.5 秒內完成）

### 切換方式
- 熱鍵：連按兩次 Alt，接著在 0.5 秒內按 W
- 托盤：滑鼠左鍵點擊托盤圖示即可切換
- 右鍵：開啟選單可關閉程式

---

## 主要功能描述

- 快速熱鍵切換：Alt、Alt、W（0.5 秒時間窗）
- 原生托盤：使用 Win32 API 與 GDI+ 載入 `繁.png`、`簡.png`、`轉.png`，左鍵可切換、右鍵可關閉
- 狀態提示：托盤提示文字會顯示目前輸出模式與快捷說明
- 自動偵測登錄路徑：程式會嘗試尋找可用的新注音（IME）登錄路徑，並確保必要鍵值存在
- 即時生效：寫入後會跳轉英文輸入法再切回新注音，迫使新狀態立即套用

---

## 系統需求

- Windows 10 / 11
- 已安裝微軟「新注音／注音」輸入法
- Python 3.8 以上
- 依賴套件：`keyboard`

---

## 安裝與首次執行

1. 下載或複製本資料夾內容：
   - `新注音繁簡快速切換.pyw`

   - `繁.png`、`簡.png`、`轉.png`
   - `run.bat`（選用）
2. 執行 `新注音繁簡快速切換.pyw`（或執行 `run.bat`)
3. 若缺少依賴套件，程式會提示缺少模組並結束，請先在目標 Python 環境安裝完成後再啟動

（選用）手動安裝依賴套件:
```bash
py -3 -m pip install keyboard
```

---

## 設計初衷

其實就是我平時工作有被要求需要直面客戶，需要和對岸的客戶溝通，但同時又要和這邊的同事溝通。
而我們各自都有自己的閱讀習慣，對岸的人不喜歡看我們的繁體，我也用不慣拼音。
公司內部和我自己習慣也是使用繁體中文，但是新注音的繁簡切換雖然不麻煩，但每次都要進設定去調整，頻繁調整就有點煩躁。
香港那邊的輸入法就有繁簡快速切換快速鍵，注音就沒有，但微軟完全無視我們這個需求。
我提過，但對面給的回應卻是"需求比例較低"、"不影響使用"、"優先權低"，會加上排程，但請不要抱持希望。
好吧，我自己做。
而我們各自都有自己的閱讀習慣，對岸的人不喜歡看我們的繁體，我也用不慣拼音。<br>
公司內部和我自己習慣也是使用繁體中文，但是新注音的繁簡切換雖然不麻煩，但每次都要進設定去調整，頻繁調整就有點煩躁。<br>
香港那邊的輸入法就有繁簡快速切換快速鍵，注音就沒有，但微軟完全無視我們這個需求。<br>
我提過，但對面給的回應卻是"需求比例較低"、"不影響使用"、"優先權低"，會加上排程，但請不要抱持希望。<br>
好吧，我自己做。<br>
-- by AZLDC